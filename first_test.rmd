---
title: "Hme Credit Risk Graphs"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.
When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).
The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.

```{r}
library(ggplot2)
library(data.table)
library(psych)
library(skimr)
library(reshape2)
getwd()
```


```{r}
application_train = read.csv("C:/Users/Eda/Documents/courses/CSIS_3360/Project/home_credit_risk_project/data/application_train.csv")
```


```{r}
data(head(application_train))
str(application_train)
```
```{r}
## change all character variables to factors. since they are in fact factors. 
for (c in colnames(application_train)){
       if(class(application_train[[c]])=='character'  ) {
          application_train[[c]] = as.factor(application_train[[c]])
    }
}
```


```{r}
application_train[ , grepl( "FLAG" , names( application_train ) ) ] = lapply(application_train[ , grepl( "FLAG" , names( application_train ) ) ],factor)
application_train[ , grepl( "FLAG" , names( application_train ) ) ]
application_train[ ,'TARGET'] = as.factor(application_train[ ,'TARGET'])

```

Above , we changed FLAG columns as categorical variables since they are not really numerical but True/False columns.Also Target column is categorical dependent variable, hence we change it to factor.

```{r}
summary(application_train)
```

```{r}
skimr::skim(application_train)
```

Let's start graphs. First We will use the name df for simplifying the code. 

```{r}
df = application_train
```

```{r}
for (c in colnames(df)){
       if(class(df[[c]])=='numeric' | class(df[[c]])=='integer'  ) {
           df_uniq = unique(df[[c]])
           print(c,str(length(df_uniq)))
    }
}
```

Boxplots for outliers: 

```{r}

for (c in colnames(df)){
       if(class(df[[c]])=='numeric' | class(df[[c]])=='integer'  ) {
        boxplot(df[[c]] ~ TARGET, data = df, col = "red",ylab = c)   
    }
}
```


Histograms:

```{r}
library(hrbrthemes)
##to try 
ggplot(df,aes(x=DAYS_LAST_PHONE_CHANGE,binwidth=.1, group=TARGET,fill=TARGET))+
  geom_histogram(position="dodge")+theme_bw()


for (c in colnames(df)){
  if(class(df[[c]])=='numeric' | class(df[[c]])=='integer'  ) {
    df_uniq = unique(df[[c]])
    if(length(df_uniq) > 30 ) {
      c
      binw = (max(df[[c]], na.rm=T) - min(df[[c]], na.rm=T)) / sqrt(307512)
      binw
         ggplot(df, aes(x=df[[c]], fill=TARGET)) +
        geom_histogram( color="#e9ecef", alpha=0.6, position = 'identity') +
       scale_fill_manual(values=c("#69b3a2", "#404080")) +
        theme_bw() +
        labs(fill="")
    }
  }
}
```

